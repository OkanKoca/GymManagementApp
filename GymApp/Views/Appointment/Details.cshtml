@model GymApp.Models.Appointment
@{
    ViewData["Title"] = "Randevu Detayý";
    // Türkiye saat dilimi
    var turkeyTimeZone = TimeZoneInfo.FindSystemTimeZoneById("Turkey Standard Time");
    var startTime = TimeZoneInfo.ConvertTimeFromUtc(Model.StartAt, turkeyTimeZone);
    var endTime = TimeZoneInfo.ConvertTimeFromUtc(Model.EndAt, turkeyTimeZone);
    var createdTime = TimeZoneInfo.ConvertTimeFromUtc(Model.CreatedAt, turkeyTimeZone);

    var statusBadge = Model.Status switch
    {
        "Pending" => "warning",
        "Approved" => "success",
        "Rejected" => "danger",
        "Completed" => "info",
        "Canceled" => "secondary",
        _ => "secondary"
    };
    var statusText = Model.Status switch
    {
        "Pending" => "Onay Bekliyor",
        "Approved" => "Onaylandý",
        "Rejected" => "Reddedildi",
        "Completed" => "Tamamlandý",
        "Canceled" => "Ýptal Edildi",
        _ => Model.Status
    };
}

<div class="row justify-content-center">
    <div class="col-md-8">
        <div class="card shadow">
            <div class="card-header bg-primary text-white d-flex justify-content-between align-items-center">
                <h4 class="mb-0"><i class="bi bi-calendar-event"></i> Randevu Detayý</h4>
                <span class="badge bg-@statusBadge fs-6">@statusText</span>
            </div>
            <div class="card-body">
                <div class="row">
                    <div class="col-md-6">
                        <h5 class="text-primary"><i class="bi bi-person"></i> Üye Bilgileri</h5>
                        <hr />
                        <p><strong>Ad Soyad:</strong> @Model.Member?.FullName</p>
                        <p><strong>E-posta:</strong> @Model.Member?.Email</p>
                    </div>
                    <div class="col-md-6">
                        <h5 class="text-primary"><i class="bi bi-person-badge"></i> Eðitmen Bilgileri</h5>
                        <hr />
                        <p><strong>Ad Soyad:</strong> @Model.Trainer?.FullName</p>
                        <p><strong>Uzmanlýk:</strong> @Model.Trainer?.Expertise</p>
                        <p><strong>Salon:</strong> @Model.Trainer?.Gym?.Name</p>
                    </div>
                </div>

                <div class="row mt-4">
                    <div class="col-md-6">
                        <h5 class="text-primary"><i class="bi bi-clipboard-check"></i> Hizmet Bilgileri</h5>
                        <hr />
                        <p><strong>Hizmet:</strong> @Model.Service?.Name</p>
                        <p><strong>Süre:</strong> @Model.Service?.DurationMinutes dakika</p>
                        <p><strong>Ücret:</strong> @Model.Service?.Price.ToString("C")</p>
                    </div>
                    <div class="col-md-6">
                        <h5 class="text-primary"><i class="bi bi-clock"></i> Randevu Bilgileri</h5>
                        <hr />
                        <p><strong>Tarih:</strong> @startTime.ToString("dd MMMM yyyy dddd", new System.Globalization.CultureInfo("tr-TR"))</p>
                        <p><strong>Saat:</strong> @startTime.ToString("HH:mm") - @endTime.ToString("HH:mm")</p>
                        <p><strong>Oluþturulma:</strong> @createdTime.ToString("dd.MM.yyyy HH:mm")</p>
                    </div>
                </div>

                @if (!string.IsNullOrEmpty(Model.Notes))
                {
                    <div class="mt-4">
                        <h5 class="text-primary"><i class="bi bi-sticky"></i> Notlar</h5>
                        <hr />
                        <p>@Model.Notes</p>
                    </div>
                }
            </div>
            <div class="card-footer d-flex justify-content-between">
                <a asp-action="Index" class="btn btn-secondary">
                    <i class="bi bi-arrow-left"></i> Geri
                </a>
                @if (Model.Status == "Pending" || Model.Status == "Approved")
                {
                    <form asp-action="Cancel" asp-route-id="@Model.Id" method="post"
                          onsubmit="return confirm('Randevuyu iptal etmek istediðinize emin misiniz?')">
                        <button type="submit" class="btn btn-danger">
                            <i class="bi bi-x-circle"></i> Ýptal Et
                        </button>
                    </form>
                }
            </div>
        </div>
    </div>
</div>
