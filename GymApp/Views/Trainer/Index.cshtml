@model List<GymApp.Models.Trainer>
@{
    ViewData["Title"] = "Eðitmenler";
}

<div class="d-flex justify-content-between align-items-center mb-4">
 <div>
      <h2 class="fw-bold"><i class="bi bi-person-badge me-2" style="color: var(--gym-accent);"></i>Eðitmenler</h2>
        <p class="text-muted mb-0">Uzman eðitmenlerimizle tanýþýn</p>
    </div>
    @if (User.IsInRole("Admin"))
    {
        <a class="btn btn-success" asp-action="Create">
            <i class="bi bi-plus-circle me-1"></i> Yeni Eðitmen
     </a>
    }
</div>

@if (TempData["Success"] != null)
{
    <div class="alert alert-success alert-dismissible fade show" role="alert">
     <i class="bi bi-check-circle me-2"></i>@TempData["Success"]
    <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
    </div>
}

@if (TempData["Error"] != null)
{
    <div class="alert alert-danger alert-dismissible fade show" role="alert">
      <i class="bi bi-exclamation-triangle me-2"></i>@TempData["Error"]
   <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
    </div>
}

@if (!Model.Any())
{
    <div class="alert alert-info">
        <i class="bi bi-info-circle me-2"></i>Henüz kayýtlý eðitmen bulunmamaktadýr.
    </div>
}
else
{
    <div class="row g-4">
@foreach (var t in Model)
        {
    <div class="col-md-6 col-lg-4">
        <div class="card h-100 hover-card">
             <div class="card-body p-4">
         <div class="text-center mb-3">
           @if (!string.IsNullOrEmpty(t.PhotoUrl))
       {
       <div class="position-relative d-inline-block">
       <img src="@t.PhotoUrl" alt="@t.FullName" class="rounded-circle" style="width: 120px; height: 120px; object-fit: cover; border: 4px solid var(--gym-accent); box-shadow: var(--gym-shadow-accent);" />
      <div class="position-absolute bottom-0 end-0 bg-success rounded-circle p-2" style="width: 35px; height: 35px;">
             <i class="bi bi-check-lg text-white"></i>
            </div>
     </div>
                 }
         else
            {
       <div class="d-inline-flex rounded-circle p-4" style="background: linear-gradient(135deg, var(--gym-accent), var(--gym-accent-dark)); box-shadow: var(--gym-shadow-accent);">
               <i class="bi bi-person-badge" style="font-size: 3rem; color: var(--gym-bg);"></i>
         </div>
          }
          </div>
  <h5 class="card-title text-center fw-bold mb-2">@t.FullName</h5>
         <p class="text-center mb-3">
    <span class="badge" style="background: linear-gradient(135deg, var(--gym-primary), var(--gym-primary-dark));">@t.Expertise</span>
            </p>

             @if (t.ExperienceYears.HasValue)
    {
        <div class="text-center mb-3">
       <span class="badge bg-warning text-dark">
     <i class="bi bi-award me-1"></i>@t.ExperienceYears yýl deneyim
         </span>
 </div>
          }

        @if (!string.IsNullOrEmpty(t.Bio))
       {
     <p class="card-text text-muted small text-center mb-3 px-2">@(t.Bio?.Length > 80 ? t.Bio.Substring(0, 80) + "..." : t.Bio)</p>
}

       <hr style="border-color: rgba(255, 255, 255, 0.1);" />

            <div class="small">
           <div class="d-flex align-items-center mb-2">
             <i class="bi bi-building me-2" style="color: var(--gym-primary); font-size: 1.1rem;"></i>
           <span>@(t.Gym?.Name ?? "Belirtilmemiþ")</span>
    </div>

          @if (!string.IsNullOrEmpty(t.Email))
        {
      <div class="d-flex align-items-center mb-2">
 <i class="bi bi-envelope me-2" style="color: var(--gym-info); font-size: 1.1rem;"></i>
   <span class="text-truncate">@t.Email</span>
      </div>
         }

                   @if (!string.IsNullOrEmpty(t.Phone))
    {
    <div class="d-flex align-items-center mb-2">
    <i class="bi bi-telephone me-2" style="color: var(--gym-accent); font-size: 1.1rem;"></i>
       <span>@t.Phone</span>
              </div>
        }

     <div class="d-flex align-items-start mt-3">
          <i class="bi bi-calendar-check me-2 mt-1" style="color: var(--gym-warning); font-size: 1.1rem;"></i>
    <div class="flex-grow-1">
       <strong class="d-block mb-1">Müsaitlik:</strong>
     @if (t.Availabilities != null && t.Availabilities.Any())
         {
    <div class="d-flex flex-wrap gap-1">
    @foreach (var av in t.Availabilities.Take(7))
   {
      <span class="badge bg-success">@GetDayName(av.Day)</span>
   }
      </div>
  }
        else
     {
        <span class="badge bg-secondary">Belirlenmedi</span>
          }
            </div>
     </div>
    </div>
       </div>

                    @if (User.IsInRole("Admin"))
        {
        <div class="card-footer bg-transparent border-0 text-center py-3">
        <div class="btn-group" role="group">
      <a asp-action="Edit" asp-route-id="@t.Id" class="btn btn-sm btn-outline-primary">
          <i class="bi bi-pencil"></i> Düzenle
     </a>
          <a asp-action="Delete" asp-route-id="@t.Id" class="btn btn-sm btn-outline-danger">
                <i class="bi bi-trash"></i> Sil
           </a>
           </div>
             </div>
     }

     @if (User.Identity?.IsAuthenticated == true && !User.IsInRole("Admin"))
           {
               <div class="card-footer bg-transparent border-0 text-center pb-3">
         <a asp-controller="Appointment" asp-action="Create" class="btn btn-success w-100">
  <i class="bi bi-calendar-plus me-1"></i> Randevu Al
      </a>
               </div>
      }
          </div>
</div>
   }
    </div>
}

@functions {
    string GetDayName(DayOfWeek day)
    {
      return day switch
      {
            DayOfWeek.Monday => "Pzt",
            DayOfWeek.Tuesday => "Sal",
   DayOfWeek.Wednesday => "Çar",
      DayOfWeek.Thursday => "Per",
          DayOfWeek.Friday => "Cum",
            DayOfWeek.Saturday => "Cmt",
        DayOfWeek.Sunday => "Paz",
            _ => ""
        };
    }
}
